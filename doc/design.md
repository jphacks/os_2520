# フロント設計

## 画面・機能一覧

### I. 認証・グループ参加フェーズ（ログイン前/初回）

| 画面名                                                                         | 対象ユーザー                           | 必須機能（操作）                                                   | 呼び出す API            |
| ------------------------------------------------------------------------------ | -------------------------------------- | ------------------------------------------------------------------ | ----------------------- |
| **ログイン画面**                                                               | 全員                                   | 1. **「LINE でログイン」ボタン**を押す                             | `POST /auth/line`       |
| → LINE 認証後、取得した ID トークンを送信。JWT と`isNewUser`フラグを受け取る。 |
| **ユーザー情報入力画面**                                                       | 全員（初回）                           | 1. 役割と氏名を入力し、**「次へ」ボタン**を押す                    | `PUT /users/me/profile` |
| → 初回ユーザーが自身の役割と表示名を設定するための API。                       |
| **家族グループ選択/作成画面**                                                  | 全員（初回）                           | 1. 「新しい家族グループを作成」へ進む                              |
| 2. 「既存グループに参加」へ進む                                                | (画面遷移のみのため、API 呼び出しなし) |
| **新規グループ作成画面**                                                       | 代表者のみ                             | 1. グループ情報を入力し、**「グループを作成」ボタン**を押す        | `POST /groups`          |
| → グループ名、パスワード等を送信。成功すると招待用 ID が返る。                 |
| **グループ参加画面**                                                           | 招待されたメンバー                     | 1. ID とパスワードを入力し、**「グループに参加する」ボタン**を押す | `POST /groups/join`     |
| → グループへの参加リクエストを送信する。                                       |

### II. 祖父母（出題者）向け画面

| 画面名                                                             | 必須機能（操作）                     | 呼び出す API             |
| ------------------------------------------------------------------ | ------------------------------------ | ------------------------ |
| **祖父母ダッシュボード（ホーム）**                                 | **画面表示時**                       | `GET /quizzes/history`   |
| → 過去のクイズ一覧と、それに対する家族の回答状況を取得・表示する。 |
|                                                                    | **緊急通知ボタン**を押す             | `POST /alerts/emergency` |
| → 家族全員へ緊急通知を送信する。                                   |
| **クイズ作成・出題画面**                                           | **「クイズを出題する」ボタン**を押す | `POST /quizzes`          |
| → 作成したクイズの本文と選択肢をサーバーに送信する。               |

### III. 子・孫（回答者）向け画面

| 画面名                             | 必須機能（操作） | 呼び出す API                      |
| ---------------------------------- | ---------------- | --------------------------------- |
| **子・孫ダッシュボード（ホーム）** | **画面表示時**   | **(複数 API を並行して呼び出す)** |

1. `GET /quizzes/pending`
   → 未回答クイズを取得
2. `GET /quizzes/history`
   → 安否状況や過去クイズ一覧を表示
3. `GET /groups/stats/members`
   → 正答率ランキングを表示 |
   | **クイズ回答画面** | **選択肢をタップ**して回答する | `POST /quizzes/:quizId/answer`
   → ユーザーが選択した答えを送信し、正解/不正解の結果を受け取る。 |

## 画面設計書（項目定義）

### I. 認証・グループ参加フェーズ（ログイン前/初回）

| 画面名                        | 項目/部品名                                                                  | 種別 (Type)      | 必須/任意 | 入力制限/選択肢           | 説明・備考                                         |
| ----------------------------- | ---------------------------------------------------------------------------- | ---------------- | --------- | ------------------------- | -------------------------------------------------- |
| **ログイン画面**              | アプリの概要説明&友達追加の説明                                              | テキスト表示     | 必須      | -                         | アプリの目的と価値を説明                           |
|                               | **「LINE でログイン」ボタン**                                                | ボタン           | 必須      | -                         | クリックで LINE 認証画面へ遷移                     |
| **ユーザー情報入力画面**      | ユーザー役割選択                                                             | ラジオボタン     | 必須      | 祖父母 / 子・孫           | どちらかを選択。選択によってダッシュボードが変わる |
|                               | 氏名（アプリ内表示名）                                                       | テキスト入力     | 必須      | 最大 20 文字              | LINE の表示名とは別に、アプリ内で使用する名前      |
|                               | 「次へ」ボタン                                                               | ボタン           | 必須      | -                         |                                                    |
| **家族グループ選択/作成画面** | **「新しい家族グループを作成」ボタン**                                       | ボタン           | 必須      | -                         | 代表者が押下し、作成画面へ遷移                     |
|                               | **「既存グループに参加」ボタン**                                             | ボタン           | 必須      | -                         | 招待されたメンバーが押下し、参加画面へ遷移         |
| **新規グループ作成画面**      | グループ名                                                                   | テキスト入力     | 必須      | 最大 30 文字              | 家族グループの名前（例：山田家、祖父と孫たち）     |
|                               | パスワード                                                                   | テキスト入力     | 必須      | 最低 8 文字、最長 36 文字 |                                                    |
|                               | **クイズ出題頻度**                                                           | セレクトボックス | 必須      | 1~7 日間(0.5 刻み)        | 祖父母がクイズを出さない場合にアラートを出す期間   |
|                               | **招待用グループ ID 表示(モーダル)**                                         | テキスト表示     | 必須      | 英数字 8 文字（自動生成） |
| サーバーからの返却            | グループ作成後、サーバーからグループ ID が返却され、それをモーダルで表示する |
|                               | **ID コピーボタン(同上モーダル)**                                            | ボタン           | 必須      | -                         | グループ ID をクリップボードにコピー               |
|                               | 「グループを作成」ボタン                                                     | ボタン           | 必須      | -                         |                                                    |
| **グループ参加画面**          | **招待されたグループ ID**                                                    | テキスト入力     | 必須      | 英数字 8 文字             | 招待されたグループ ID を入力                       |
|                               | パスワード                                                                   | テキスト入力     | 必須      | 最低 8 文字、最長 36 文字 |                                                    |
|                               | 「グループに参加」ボタン                                                     | ボタン           | 必須      | -                         | 入力 ID に基づいて参加処理を実行                   |

---

### II. 祖父母（出題者）向け画面

| 画面名                             | 項目/部品名                | 種別 (Type)         | 必須/任意 | 入力制限/選択肢                          | 説明・備考                                          |
| ---------------------------------- | -------------------------- | ------------------- | --------- | ---------------------------------------- | --------------------------------------------------- |
| **祖父母ダッシュボード（ホーム）** | **「クイズ作成」ボタン**   | ボタン              | 必須      | -                                        | クイズ作成画面へ遷移（最も目立たせる）              |
|                                    | 家族の最新回答状況サマリー | テキスト/グラフ表示 | 必須      | -                                        | 例: 3 人中 2 人回答済み、平均正答率 85%             |
|                                    | **緊急通知ボタン**         | ボタン              | 必須      | -                                        | 押下で家族全員に緊急アラートを送信                  |
|                                    | クイズ出題促しメッセージ   | テキスト表示        | 必須      | -                                        | 「今日はまだクイズを出していませんよ！」など        |
|                                    | 過去の出題クイズ一覧       | リスト表示          | 必須      | 日付、クイズ本文、正答率                 | 過去のクイズをリスト形式で表示                      |
|                                    | 個別クイズ詳細（正答率）   | テキスト/リスト表示 | 必須      | -                                        | 誰が正解/不正解したか、各回答者の正答率を表示       |
| **クイズ作成・出題画面**           | クイズテーマのおすすめ表示 | リスト/ボタン       | 任意      | 例: 昨日あったこと、学生時代、地元クイズ | テーマを選ぶと、本文のヒントになる                  |
|                                    | クイズ本文                 | テキストエリア      | 必須      | 最大 100 文字                            | 祖父母が作成するエピソードクイズの質問文            |
|                                    | 選択肢 1〜4                | テキスト入力        | 必須      | 最大 20 文字                             | 選択肢の内容。4 つ全て入力必須。                    |
|                                    | 正解指定                   | ラジオボタン        | 必須      | 選択肢 1〜4                              | どの選択肢が正解かを指定                            |
|                                    | 「クイズを出題する」ボタン | ボタン              | 必須      | -                                        |                                                     |
| **設定画面（祖父母用）**           | LINE 連携確認              | テキスト表示        | 必須      | 連携済み/未連携                          |                                                     |
|                                    | クイズ出題要請通知         | トグルスイッチ      | 必須      | ON/OFF                                   | LINE で「クイズを出して」という通知を受け取るか設定 |

---

### III. 子・孫（回答者）向け画面

| 画面名                             | 項目/部品名                       | 種別 (Type)             | 必須/任意 | 入力制限/選択肢           | 説明・備考                                 |
| ---------------------------------- | --------------------------------- | ----------------------- | --------- | ------------------------- | ------------------------------------------ |
| **子・孫ダッシュボード（ホーム）** | **未回答のクイズ導線**            | ボタン/カード           | 必須      | -                         | 未回答クイズの数と「回答する」ボタン       |
|                                    | **安否確認アラート表示**          | テキスト/アイコン       | 必須      | 正常 / 要確認（期間超過） | クイズ出題頻度に基づき、祖父母の状態を表示 |
|                                    | 祖父母の最終クイズ出題日時        | テキスト表示            | 必須      | -                         | 最後にクイズが出た日時                     |
|                                    | 回答者ごとの正答率ランキング      | リスト表示              | 必須      | -                         | メンバーの名前と正答率（ランキング形式）   |
|                                    | 過去の出題クイズ一覧              | リスト表示              | 必須      | 日付、クイズ本文、正答率  | 祖父母のダッシュボードと同一画面           |
|                                    | 個別クイズ詳細（正答率）          | テキスト/リスト表示     | 必須      | -                         | 祖父母のダッシュボードと同一画面           |
| **クイズ回答画面**                 | クイズ文と選択肢                  | テキスト/ボタン         | 必須      | -                         | 選択肢をタップして回答                     |
|                                    | 回答後の正解/不正解フィードバック | テキスト/アニメーション | 必須      | 正解 / 不正解             | 回答直後に表示                             |
|                                    | (発展) 祖父母へのメッセージ       | テキスト入力            | 任意      | 最大 50 文字              | 回答後、祖父母に送る簡単なコメント         |
|                                    | 「次へ/ホームへ戻る」ボタン       | ボタン                  | 必須      | -                         |                                            |
